<!DOCTYPE html><html><head><title>tisensortag.js</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="../../../docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="../../../index.html" class="source"><span class="file_name">README</span></a><a href="../../../app.coffee.html" class="source "><span class="base_path">. / </span><span class="file_name">app.coffee</span></a><a href="../../../libs/evothings/easyble/easyble.js.html" class="source "><span class="base_path">libs / evothings / easyble / </span><span class="file_name">easyble.js</span></a><a href="../../../libs/evothings/tisensortag/tisensortag.js.html" class="source selected"><span class="base_path">libs / evothings / tisensortag / </span><span class="file_name">tisensortag.js</span></a><a href="../../../libs/evothings/util/util.js.html" class="source "><span class="base_path">libs / evothings / util / </span><span class="file_name">util.js</span></a><a href="../../../pages.coffee.html" class="source "><span class="base_path">. / </span><span class="file_name">pages.coffee</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>tisensortag.js</h1><div class="filepath">libs/evothings/tisensortag/</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>File: tisensortag.js<br />Description: JavaScript library for the TI SensorTag.<br />Author: Miki</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><p>Documentation for the TI SensorTag:
http://processors.wiki.ti.com/index.php/SensorTag<em>User</em>Guide
http://processors.wiki.ti.com/index.php/File:BLE<em>SensorTag</em>GATT_Server.pdf</p>
</td><td class="code"><div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">window</span><span class="p">.</span><span class="nx">evothings</span><span class="p">)</span> <span class="p">{</span> <span class="nb">window</span><span class="p">.</span><span class="nx">evothings</span> <span class="o">=</span> <span class="p">{}</span> <span class="p">}</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">tisensortag</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kd">var</span> <span class="nx">sensortag</span> <span class="o">=</span> <span class="p">{}</span>

  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">DEVICEINFO_SERVICE</span> <span class="o">=</span> <span class="s1">&#39;0000180a-0000-1000-8000-00805f9b34fb&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">FIRMWARE_DATA</span> <span class="o">=</span> <span class="s1">&#39;00002a26-0000-1000-8000-00805f9b34fb&#39;</span>

  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">IRTEMPERATURE_SERVICE</span> <span class="o">=</span> <span class="s1">&#39;f000aa00-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">IRTEMPERATURE_DATA</span> <span class="o">=</span> <span class="s1">&#39;f000aa01-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">IRTEMPERATURE_CONFIG</span> <span class="o">=</span> <span class="s1">&#39;f000aa02-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">IRTEMPERATURE_PERIOD</span> <span class="o">=</span> <span class="s1">&#39;f000aa03-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">IRTEMPERATURE_NOTIFICATION</span> <span class="o">=</span> <span class="s1">&#39;00002902-0000-1000-8000-00805f9b34fb&#39;</span>

  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">ACCELEROMETER_SERVICE</span> <span class="o">=</span> <span class="s1">&#39;f000aa10-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">ACCELEROMETER_DATA</span> <span class="o">=</span> <span class="s1">&#39;f000aa11-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">ACCELEROMETER_CONFIG</span> <span class="o">=</span> <span class="s1">&#39;f000aa12-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">ACCELEROMETER_PERIOD</span> <span class="o">=</span> <span class="s1">&#39;f000aa13-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">ACCELEROMETER_NOTIFICATION</span> <span class="o">=</span> <span class="s1">&#39;00002902-0000-1000-8000-00805f9b34fb&#39;</span>

  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">HUMIDITY_SERVICE</span> <span class="o">=</span> <span class="s1">&#39;f000aa20-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">HUMIDITY_DATA</span> <span class="o">=</span> <span class="s1">&#39;f000aa21-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">HUMIDITY_CONFIG</span> <span class="o">=</span> <span class="s1">&#39;f000aa22-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">HUMIDITY_PERIOD</span> <span class="o">=</span> <span class="s1">&#39;f000aa23-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">HUMIDITY_NOTIFICATION</span> <span class="o">=</span> <span class="s1">&#39;00002902-0000-1000-8000-00805f9b34fb&#39;</span>

  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">MAGNETOMETER_SERVICE</span> <span class="o">=</span> <span class="s1">&#39;f000aa30-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">MAGNETOMETER_DATA</span> <span class="o">=</span> <span class="s1">&#39;f000aa31-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">MAGNETOMETER_CONFIG</span> <span class="o">=</span> <span class="s1">&#39;f000aa32-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">MAGNETOMETER_PERIOD</span> <span class="o">=</span> <span class="s1">&#39;f000aa33-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">MAGNETOMETER_NOTIFICATION</span> <span class="o">=</span> <span class="s1">&#39;00002902-0000-1000-8000-00805f9b34fb&#39;</span>

  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">BAROMETER_SERVICE</span> <span class="o">=</span> <span class="s1">&#39;f000aa40-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">BAROMETER_DATA</span> <span class="o">=</span> <span class="s1">&#39;f000aa41-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">BAROMETER_CONFIG</span> <span class="o">=</span> <span class="s1">&#39;f000aa42-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">BAROMETER_CALIBRATION</span> <span class="o">=</span> <span class="s1">&#39;f000aa43-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">BAROMETER_PERIOD</span> <span class="o">=</span> <span class="s1">&#39;f000aa44-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">BAROMETER_NOTIFICATION</span> <span class="o">=</span> <span class="s1">&#39;00002902-0000-1000-8000-00805f9b34fb&#39;</span>

  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">GYROSCOPE_SERVICE</span> <span class="o">=</span> <span class="s1">&#39;f000aa50-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">GYROSCOPE_DATA</span> <span class="o">=</span> <span class="s1">&#39;f000aa51-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">GYROSCOPE_CONFIG</span> <span class="o">=</span> <span class="s1">&#39;f000aa52-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">GYROSCOPE_PERIOD</span> <span class="o">=</span> <span class="s1">&#39;f000aa53-0451-4000-b000-000000000000&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">GYROSCOPE_NOTIFICATION</span> <span class="o">=</span> <span class="s1">&#39;00002902-0000-1000-8000-00805f9b34fb&#39;</span>

  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">KEYPRESS_SERVICE</span> <span class="o">=</span> <span class="s1">&#39;0000ffe0-0000-1000-8000-00805f9b34fb&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">KEYPRESS_DATA</span> <span class="o">=</span> <span class="s1">&#39;0000ffe1-0000-1000-8000-00805f9b34fb&#39;</span>
  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">KEYPRESS_NOTIFICATION</span> <span class="o">=</span> <span class="s1">&#39;00002902-0000-1000-8000-00805f9b34fb&#39;</span></pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Internal. Override if needed.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">deviceIsSensorTag</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">device</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">device</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
      <span class="p">(</span><span class="nx">device</span><span class="p">.</span><span class="nx">name</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
      <span class="p">(</span><span class="nx">device</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;Sensor Tag&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span>
        <span class="nx">device</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;SensorTag&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  <span class="p">}</span></pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>For debugging.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">logServices</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">device</span><span class="p">)</span>
  <span class="p">{</span></pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><p>Here we simply print found services, characteristics,
and descriptors to the debug console in Evothings Workbench.</p>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-6"><td class="docs"><div class="pilwrap"><a href="#section-6" class="pilcrow">&#182;</a></div><p>Print all services.</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">serviceUUID</span> <span class="k">in</span> <span class="nx">device</span><span class="p">.</span><span class="nx">__services</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">service</span> <span class="o">=</span> <span class="nx">device</span><span class="p">.</span><span class="nx">__services</span><span class="p">[</span><span class="nx">serviceUUID</span><span class="p">]</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;  service: &#39;</span> <span class="o">+</span> <span class="nx">service</span><span class="p">.</span><span class="nx">uuid</span><span class="p">)</span></pre></div></td></tr><tr id="section-7"><td class="docs"><div class="pilwrap"><a href="#section-7" class="pilcrow">&#182;</a></div><p>Print all characteristics for service.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">characteristicUUID</span> <span class="k">in</span> <span class="nx">service</span><span class="p">.</span><span class="nx">__characteristics</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">characteristic</span> <span class="o">=</span> <span class="nx">service</span><span class="p">.</span><span class="nx">__characteristics</span><span class="p">[</span><span class="nx">characteristicUUID</span><span class="p">]</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39; characteristic: &#39;</span> <span class="o">+</span> <span class="nx">characteristic</span><span class="p">.</span><span class="nx">uuid</span><span class="p">)</span></pre></div></td></tr><tr id="section-8"><td class="docs"><div class="pilwrap"><a href="#section-8" class="pilcrow">&#182;</a></div><p>Print all descriptors for characteristic.</p>
</td><td class="code"><div class="highlight"><pre>        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">descriptorUUID</span> <span class="k">in</span> <span class="nx">characteristic</span><span class="p">.</span><span class="nx">__descriptors</span><span class="p">)</span>
        <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">descriptor</span> <span class="o">=</span> <span class="nx">characteristic</span><span class="p">.</span><span class="nx">__descriptors</span><span class="p">[</span><span class="nx">descriptorUUID</span><span class="p">]</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;   descriptor: &#39;</span> <span class="o">+</span> <span class="nx">descriptor</span><span class="p">.</span><span class="nx">uuid</span><span class="p">)</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span></pre></div></td></tr><tr id="section-9"><td class="docs"><div class="pilwrap"><a href="#section-9" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Create tag instance.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">sensortag</span><span class="p">.</span><span class="nx">createInstance</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span></pre></div></td></tr><tr id="section-10"><td class="docs"><div class="pilwrap"><a href="#section-10" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Internal. Variable holding the sensor tag instance object.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">instance</span> <span class="o">=</span> <span class="p">{}</span></pre></div></td></tr><tr id="section-11"><td class="docs"><div class="pilwrap"><a href="#section-11" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Internal. Services used by the application.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">requiredServices</span> <span class="o">=</span> <span class="p">[]</span></pre></div></td></tr><tr id="section-12"><td class="docs"><div class="pilwrap"><a href="#section-12" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Internal. Default error handler function.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">errorFun</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;SensorTag error: &#39;</span> <span class="o">+</span> <span class="nx">error</span><span class="p">)</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-13"><td class="docs"><div class="pilwrap"><a href="#section-13" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Internal. Default status handler function.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">status</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;SensorTag status: &#39;</span> <span class="o">+</span> <span class="nx">status</span><span class="p">)</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-14"><td class="docs"><div class="pilwrap"><a href="#section-14" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Set the IR temperature notification callback.
     * @param fun - success callback called repeatedly: fun(data)
     * @param interval - update rate in milliseconds (min 300ms)</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">irTemperatureCallback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fun</span><span class="p">,</span> <span class="nx">interval</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">irTemperatureFun</span> <span class="o">=</span> <span class="nx">fun</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">irTemperatureConfig</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">// on</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">irTemperatureInterval</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="nx">interval</span><span class="p">)</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">requiredServices</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">IRTEMPERATURE_SERVICE</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-15"><td class="docs"><div class="pilwrap"><a href="#section-15" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Set the accelerometer notification callback.
     * @param fun - success callback called repeatedly: fun(data)
     * @param interval - accelerometer rate in milliseconds.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">accelerometerCallback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fun</span><span class="p">,</span> <span class="nx">interval</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">accelerometerFun</span> <span class="o">=</span> <span class="nx">fun</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">accelerometerConfig</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">// on</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">accelerometerInterval</span> <span class="o">=</span> <span class="nx">interval</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">requiredServices</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">ACCELEROMETER_SERVICE</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-16"><td class="docs"><div class="pilwrap"><a href="#section-16" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Set the humidity notification callback.
     * @param fun - success callback called repeatedly: fun(data)
     * @param interval - accelerometer rate in milliseconds.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">humidityCallback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fun</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">humidityFun</span> <span class="o">=</span> <span class="nx">fun</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">humidityConfig</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">// on</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">requiredServices</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">HUMIDITY_SERVICE</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-17"><td class="docs"><div class="pilwrap"><a href="#section-17" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Set the magnetometer notification callback.
     * @param fun - success callback called repeatedly: fun(data)
     * @param interval - magnetometer rate in milliseconds.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">magnetometerCallback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fun</span><span class="p">,</span> <span class="nx">interval</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">magnetometerFun</span> <span class="o">=</span> <span class="nx">fun</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">magnetometerConfig</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">// on</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">magnetometerInterval</span> <span class="o">=</span> <span class="nx">interval</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">requiredServices</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">MAGNETOMETER_SERVICE</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-18"><td class="docs"><div class="pilwrap"><a href="#section-18" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Set the barometer notification callback.
     * @param fun - success callback called repeatedly: fun(data)
     * @param interval - barometer rate in milliseconds.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">barometerCallback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fun</span><span class="p">,</span> <span class="nx">interval</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">barometerFun</span> <span class="o">=</span> <span class="nx">fun</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">barometerConfig</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">// on</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">barometerInterval</span> <span class="o">=</span> <span class="nx">interval</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">requiredServices</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">BAROMETER_SERVICE</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-19"><td class="docs"><div class="pilwrap"><a href="#section-19" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Set the gyroscope notification callback.
     * @param fun - success callback called repeatedly: fun(data)
     * @param interval - gyroscope rate in milliseconds.
     * @param axes - the axes to enable ((z &lt;&lt; 2) | (y &lt;&lt; 1) | x)
     * Axis parameter values are:
     * 1 = X only, 2 = Y only,
     * 3 = X and Y, 4 = Z only,
     * 5 = X and Z, 6 = Y and Z,
     * 7 = X, Y and Z.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">gyroscopeCallback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fun</span><span class="p">,</span> <span class="nx">interval</span><span class="p">,</span> <span class="nx">axes</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">gyroscopeFun</span> <span class="o">=</span> <span class="nx">fun</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">gyroscopeConfig</span> <span class="o">=</span> <span class="nx">axes</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">gyroscopeInterval</span> <span class="o">=</span> <span class="nx">interval</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">requiredServices</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">GYROSCOPE_SERVICE</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-20"><td class="docs"><div class="pilwrap"><a href="#section-20" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Set the keypress notification callback.
     * @param fun - success callback called when a key is pressed: fun(data)</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">keypressCallback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fun</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">keypressFun</span> <span class="o">=</span> <span class="nx">fun</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">requiredServices</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">KEYPRESS_SERVICE</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-21"><td class="docs"><div class="pilwrap"><a href="#section-21" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Set the error handler function.
     * @param fun - error callback: fun(error)</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">errorCallback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fun</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">errorFun</span> <span class="o">=</span> <span class="nx">fun</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-22"><td class="docs"><div class="pilwrap"><a href="#section-22" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Set the status handler function.
     * @param fun - callback: fun(status)</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">statusCallback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fun</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span> <span class="o">=</span> <span class="nx">fun</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-23"><td class="docs"><div class="pilwrap"><a href="#section-23" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Connect to the closest physical SensorTag device.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">connectToClosestDevice</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span> <span class="o">&amp;&amp;</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span><span class="p">(</span><span class="s1">&#39;Scanning...&#39;</span><span class="p">)</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">disconnectDevice</span><span class="p">()</span>
      <span class="nx">evothings</span><span class="p">.</span><span class="nx">easyble</span><span class="p">.</span><span class="nx">stopScan</span><span class="p">()</span>
      <span class="nx">evothings</span><span class="p">.</span><span class="nx">easyble</span><span class="p">.</span><span class="nx">reportDeviceOnce</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
      <span class="kd">var</span> <span class="nx">stopScanTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2000</span>
      <span class="kd">var</span> <span class="nx">closestDevice</span> <span class="o">=</span> <span class="kc">null</span>
      <span class="kd">var</span> <span class="nx">strongestRSSI</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000</span>
      <span class="nx">evothings</span><span class="p">.</span><span class="nx">easyble</span><span class="p">.</span><span class="nx">startScan</span><span class="p">(</span>
        <span class="kd">function</span><span class="p">(</span><span class="nx">device</span><span class="p">)</span>
        <span class="p">{</span></pre></div></td></tr><tr id="section-24"><td class="docs"><div class="pilwrap"><a href="#section-24" class="pilcrow">&#182;</a></div><p>Connect if we have found a sensor tag.</p>
</td><td class="code"><div class="highlight"><pre>          <span class="k">if</span> <span class="p">(</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">deviceIsSensorTag</span><span class="p">(</span><span class="nx">device</span><span class="p">)</span>
            <span class="o">&amp;&amp;</span> <span class="nx">device</span><span class="p">.</span><span class="nx">rssi</span> <span class="o">!=</span> <span class="mi">127</span> <span class="c1">// Invalid RSSI value</span>
            <span class="p">)</span>
          <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">device</span><span class="p">.</span><span class="nx">rssi</span> <span class="o">&gt;</span> <span class="nx">strongestRSSI</span><span class="p">)</span>
            <span class="p">{</span>
              <span class="nx">closestDevice</span> <span class="o">=</span> <span class="nx">device</span>
              <span class="nx">strongestRSSI</span> <span class="o">=</span> <span class="nx">device</span><span class="p">.</span><span class="nx">rssi</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="nx">stopScanTime</span><span class="p">)</span>
            <span class="p">{</span>
              <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span> <span class="o">&amp;&amp;</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span><span class="p">(</span><span class="s1">&#39;SensorTag found&#39;</span><span class="p">)</span>
              <span class="nx">evothings</span><span class="p">.</span><span class="nx">easyble</span><span class="p">.</span><span class="nx">stopScan</span><span class="p">()</span>
              <span class="nx">instance</span><span class="p">.</span><span class="nx">device</span> <span class="o">=</span> <span class="nx">closestDevice</span>
              <span class="nx">instance</span><span class="p">.</span><span class="nx">connectToDevice</span><span class="p">()</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="kd">function</span><span class="p">(</span><span class="nx">errorCode</span><span class="p">)</span>
        <span class="p">{</span>
          <span class="nx">instance</span><span class="p">.</span><span class="nx">errorFun</span><span class="p">(</span><span class="s1">&#39;Scan failed&#39;</span><span class="p">)</span>
        <span class="p">})</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-25"><td class="docs"><div class="pilwrap"><a href="#section-25" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Internal.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">connectToDevice</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span> <span class="o">&amp;&amp;</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span><span class="p">(</span><span class="s1">&#39;Connecting...&#39;</span><span class="p">)</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span>
        <span class="kd">function</span><span class="p">(</span><span class="nx">device</span><span class="p">)</span>
        <span class="p">{</span>
          <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span> <span class="o">&amp;&amp;</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span><span class="p">(</span><span class="s1">&#39;Connected&#39;</span><span class="p">)</span>
          <span class="nx">instance</span><span class="p">.</span><span class="nx">readDeviceInfo</span><span class="p">()</span>
        <span class="p">},</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">errorFun</span><span class="p">)</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-26"><td class="docs"><div class="pilwrap"><a href="#section-26" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Internal. When connected we read device info. This can be
     * used to support different firmware versions etc.
     * For now we just read the firmware version.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">readDeviceInfo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="kd">function</span> <span class="nx">gotDeviceInfoService</span><span class="p">(</span><span class="nx">device</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">readCharacteristic</span><span class="p">(</span>
          <span class="nx">sensortag</span><span class="p">.</span><span class="nx">FIRMWARE_DATA</span><span class="p">,</span>
          <span class="nx">gotFirmwareValue</span><span class="p">,</span>
          <span class="nx">instance</span><span class="p">.</span><span class="nx">errorFun</span><span class="p">)</span>
      <span class="p">}</span>

      <span class="kd">function</span> <span class="nx">gotFirmwareValue</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
      <span class="p">{</span></pre></div></td></tr><tr id="section-27"><td class="docs"><div class="pilwrap"><a href="#section-27" class="pilcrow">&#182;</a></div><p>Set firmware string.</p>
</td><td class="code"><div class="highlight"><pre>        <span class="kd">var</span> <span class="nx">fw</span> <span class="o">=</span> <span class="nx">evothings</span><span class="p">.</span><span class="nx">ble</span><span class="p">.</span><span class="nx">fromUtf8</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">firmwareString</span> <span class="o">=</span> <span class="nx">fw</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span> <span class="o">&amp;&amp;</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span><span class="p">(</span><span class="s1">&#39;Device data available&#39;</span><span class="p">)</span></pre></div></td></tr><tr id="section-28"><td class="docs"><div class="pilwrap"><a href="#section-28" class="pilcrow">&#182;</a></div><p>Continue and read services requested by the application.</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span> <span class="o">&amp;&amp;</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span><span class="p">(</span><span class="s1">&#39;Reading services...&#39;</span><span class="p">)</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">readServices</span><span class="p">(</span>
          <span class="nx">instance</span><span class="p">.</span><span class="nx">requiredServices</span><span class="p">,</span>
          <span class="nx">instance</span><span class="p">.</span><span class="nx">activateSensors</span><span class="p">,</span>
          <span class="nx">instance</span><span class="p">.</span><span class="nx">errorFun</span><span class="p">)</span>
      <span class="p">}</span></pre></div></td></tr><tr id="section-29"><td class="docs"><div class="pilwrap"><a href="#section-29" class="pilcrow">&#182;</a></div><p>Read device information service.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nx">instance</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">readServices</span><span class="p">(</span>
        <span class="p">[</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">DEVICEINFO_SERVICE</span><span class="p">],</span>
        <span class="nx">gotDeviceInfoService</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">errorFun</span><span class="p">)</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-30"><td class="docs"><div class="pilwrap"><a href="#section-30" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Get firmware string.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">getFirmwareString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">firmwareString</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-31"><td class="docs"><div class="pilwrap"><a href="#section-31" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public/Internal. Disconnect from the physical device.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">disconnectDevice</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">instance</span><span class="p">.</span><span class="nx">device</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">device</span> <span class="o">=</span> <span class="kc">null</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-32"><td class="docs"><div class="pilwrap"><a href="#section-32" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Internal.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">activateSensors</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span></pre></div></td></tr><tr id="section-33"><td class="docs"><div class="pilwrap"><a href="#section-33" class="pilcrow">&#182;</a></div><p>Debug logging.
console.log('-------------------- SERVICES --------------------')
sensortag.logServices(instance.device)
console.log('---------------------- END -----------------------')</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span> <span class="o">&amp;&amp;</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">statusFun</span><span class="p">(</span><span class="s1">&#39;Sensors online&#39;</span><span class="p">)</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">irTemperatureOn</span><span class="p">()</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">accelerometerOn</span><span class="p">()</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">humidityOn</span><span class="p">()</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">magnetometerOn</span><span class="p">()</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">barometerOn</span><span class="p">()</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">gyroscopeOn</span><span class="p">()</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">keypressOn</span><span class="p">()</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-34"><td class="docs"><div class="pilwrap"><a href="#section-34" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Turn on IR temperature notification.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">irTemperatureOn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOn</span><span class="p">(</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">IRTEMPERATURE_CONFIG</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">irTemperatureConfig</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">IRTEMPERATURE_PERIOD</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">irTemperatureInterval</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">IRTEMPERATURE_DATA</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">IRTEMPERATURE_NOTIFICATION</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">irTemperatureFun</span>
      <span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-35"><td class="docs"><div class="pilwrap"><a href="#section-35" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Turn off IR temperature notification.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">irTemperatureOff</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOff</span><span class="p">(</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">IRTEMPERATURE_DATA</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-36"><td class="docs"><div class="pilwrap"><a href="#section-36" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Turn on accelerometer notification.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">accelerometerOn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOn</span><span class="p">(</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">ACCELEROMETER_CONFIG</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">accelerometerConfig</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">ACCELEROMETER_PERIOD</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">accelerometerInterval</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">ACCELEROMETER_DATA</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">ACCELEROMETER_NOTIFICATION</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">accelerometerFun</span>
      <span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-37"><td class="docs"><div class="pilwrap"><a href="#section-37" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Turn off accelerometer notification.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">accelerometerOff</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOff</span><span class="p">(</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">ACCELEROMETER_DATA</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-38"><td class="docs"><div class="pilwrap"><a href="#section-38" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Turn on humidity notification.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">humidityOn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOn</span><span class="p">(</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">HUMIDITY_CONFIG</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">humidityConfig</span><span class="p">,</span>
        <span class="kc">null</span><span class="p">,</span> <span class="c1">// Not used.</span>
        <span class="kc">null</span><span class="p">,</span> <span class="c1">// Not used.</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">HUMIDITY_DATA</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">HUMIDITY_NOTIFICATION</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">humidityFun</span>
      <span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-39"><td class="docs"><div class="pilwrap"><a href="#section-39" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Turn off humidity notification.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">humidityOff</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOff</span><span class="p">(</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">HUMIDITY_DATA</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-40"><td class="docs"><div class="pilwrap"><a href="#section-40" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Turn on magnetometer notification.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">magnetometerOn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOn</span><span class="p">(</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">MAGNETOMETER_CONFIG</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">magnetometerConfig</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">MAGNETOMETER_PERIOD</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">magnetometerInterval</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">MAGNETOMETER_DATA</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">MAGNETOMETER_NOTIFICATION</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">magnetometerFun</span>
      <span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-41"><td class="docs"><div class="pilwrap"><a href="#section-41" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Turn off magnetometer notification.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">magnetometerOff</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOff</span><span class="p">(</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">MAGNETOMETER_DATA</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-42"><td class="docs"><div class="pilwrap"><a href="#section-42" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Turn on barometer notification.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">barometerOn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOn</span><span class="p">(</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">BAROMETER_CONFIG</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">barometerConfig</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">BAROMETER_PERIOD</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">barometerInterval</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">BAROMETER_DATA</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">BAROMETER_NOTIFICATION</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">barometerFun</span>
      <span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-43"><td class="docs"><div class="pilwrap"><a href="#section-43" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Turn off barometer notification.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">barometerOff</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOff</span><span class="p">(</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">BAROMETER_DATA</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-44"><td class="docs"><div class="pilwrap"><a href="#section-44" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Turn on gyroscope notification.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">gyroscopeOn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOn</span><span class="p">(</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">GYROSCOPE_CONFIG</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">gyroscopeConfig</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">GYROSCOPE_PERIOD</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">gyroscopeInterval</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">GYROSCOPE_DATA</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">GYROSCOPE_NOTIFICATION</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">gyroscopeFun</span>
      <span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-45"><td class="docs"><div class="pilwrap"><a href="#section-45" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Turn off gyroscope notification.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">gyroscopeOff</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOff</span><span class="p">(</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">GYROSCOPE_DATA</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-46"><td class="docs"><div class="pilwrap"><a href="#section-46" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Turn on keypress notification.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">keypressOn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOn</span><span class="p">(</span>
        <span class="kc">null</span><span class="p">,</span> <span class="c1">// Not used.</span>
        <span class="kc">null</span><span class="p">,</span> <span class="c1">// Not used.</span>
        <span class="kc">null</span><span class="p">,</span> <span class="c1">// Not used.</span>
        <span class="kc">null</span><span class="p">,</span> <span class="c1">// Not used.</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">KEYPRESS_DATA</span><span class="p">,</span>
        <span class="nx">sensortag</span><span class="p">.</span><span class="nx">KEYPRESS_NOTIFICATION</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">keypressFun</span>
      <span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-47"><td class="docs"><div class="pilwrap"><a href="#section-47" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Public. Turn off keypress notification.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">keypressOff</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOff</span><span class="p">(</span><span class="nx">sensortag</span><span class="p">.</span><span class="nx">KEYPRESS_DATA</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-48"><td class="docs"><div class="pilwrap"><a href="#section-48" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Private/public. Helper function for turning on sensor notification.
     * You can call this function from the application to enables sensors
     * using custom parameters (advanced use).</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span>
      <span class="nx">configUUID</span><span class="p">,</span>
      <span class="nx">configValue</span><span class="p">,</span>
      <span class="nx">periodUUID</span><span class="p">,</span>
      <span class="nx">periodValue</span><span class="p">,</span>
      <span class="nx">dataUUID</span><span class="p">,</span>
      <span class="nx">notificationUUID</span><span class="p">,</span>
      <span class="nx">notificationFunction</span><span class="p">)</span>
    <span class="p">{</span></pre></div></td></tr><tr id="section-49"><td class="docs"><div class="pilwrap"><a href="#section-49" class="pilcrow">&#182;</a></div><p>Only start sensor if a notification function has been set.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">notificationFunction</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span></pre></div></td></tr><tr id="section-50"><td class="docs"><div class="pilwrap"><a href="#section-50" class="pilcrow">&#182;</a></div><p>Set sensor configuration to ON.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nx">configUUID</span> <span class="o">&amp;&amp;</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">writeCharacteristic</span><span class="p">(</span>
        <span class="nx">configUUID</span><span class="p">,</span>
        <span class="k">new</span> <span class="nx">Uint8Array</span><span class="p">([</span><span class="nx">configValue</span><span class="p">]),</span>
        <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">errorFun</span><span class="p">)</span></pre></div></td></tr><tr id="section-51"><td class="docs"><div class="pilwrap"><a href="#section-51" class="pilcrow">&#182;</a></div><p>Set sensor update period.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nx">periodUUID</span> <span class="o">&amp;&amp;</span> <span class="nx">periodValue</span> <span class="o">&amp;&amp;</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">writeCharacteristic</span><span class="p">(</span>
        <span class="nx">periodUUID</span><span class="p">,</span>
        <span class="k">new</span> <span class="nx">Uint8Array</span><span class="p">([</span><span class="nx">periodValue</span> <span class="o">/</span> <span class="mi">10</span><span class="p">]),</span>
        <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">errorFun</span><span class="p">)</span></pre></div></td></tr><tr id="section-52"><td class="docs"><div class="pilwrap"><a href="#section-52" class="pilcrow">&#182;</a></div><p>Set sensor notification to ON.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nx">dataUUID</span> <span class="o">&amp;&amp;</span> <span class="nx">notificationUUID</span> <span class="o">&amp;&amp;</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">writeDescriptor</span><span class="p">(</span>
        <span class="nx">dataUUID</span><span class="p">,</span> <span class="c1">// Characteristic for data</span>
        <span class="nx">notificationUUID</span><span class="p">,</span> <span class="c1">// Configuration descriptor</span>
        <span class="k">new</span> <span class="nx">Uint8Array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span>
        <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">errorFun</span><span class="p">)</span></pre></div></td></tr><tr id="section-53"><td class="docs"><div class="pilwrap"><a href="#section-53" class="pilcrow">&#182;</a></div><p>Start sensor notification.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nx">dataUUID</span> <span class="o">&amp;&amp;</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">enableNotification</span><span class="p">(</span>
        <span class="nx">dataUUID</span><span class="p">,</span>
        <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span> <span class="nx">notificationFunction</span><span class="p">(</span><span class="k">new</span> <span class="nx">Uint8Array</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span> <span class="p">},</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">errorFun</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-54"><td class="docs"><div class="pilwrap"><a href="#section-54" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Helper function for turning off sensor notification.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">sensorOff</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dataUUID</span><span class="p">)</span>
    <span class="p">{</span></pre></div></td></tr><tr id="section-55"><td class="docs"><div class="pilwrap"><a href="#section-55" class="pilcrow">&#182;</a></div><p>Set sensor configuration to OFF</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nx">configUUID</span> <span class="o">&amp;&amp;</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">writeCharacteristic</span><span class="p">(</span>
        <span class="nx">configUUID</span><span class="p">,</span>
        <span class="k">new</span> <span class="nx">Uint8Array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span>
        <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">errorFun</span><span class="p">)</span>

      <span class="nx">dataUUID</span> <span class="o">&amp;&amp;</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">disableNotification</span><span class="p">(</span>
        <span class="nx">dataUUID</span><span class="p">,</span>
        <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
        <span class="nx">instance</span><span class="p">.</span><span class="nx">errorFun</span><span class="p">)</span>

      <span class="k">return</span> <span class="nx">instance</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-56"><td class="docs"><div class="pilwrap"><a href="#section-56" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Calculate IR temperature values from raw data.
     * @param data - an Uint8Array.
     * @return Object with fields: ambientTemperature, targetTemperature.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">getIRTemperatureValues</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">{</span></pre></div></td></tr><tr id="section-57"><td class="docs"><div class="pilwrap"><a href="#section-57" class="pilcrow">&#182;</a></div><p>Calculate ambient temperature (Celsius).</p>
</td><td class="code"><div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">ac</span> <span class="o">=</span> <span class="nx">evothings</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">littleEndianToUint16</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">128.0</span></pre></div></td></tr><tr id="section-58"><td class="docs"><div class="pilwrap"><a href="#section-58" class="pilcrow">&#182;</a></div><p>Calculate target temperature (Celsius, based on ambient).</p>
</td><td class="code"><div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">Vobj2</span> <span class="o">=</span> <span class="nx">evothings</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">littleEndianToInt16</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.00000015625</span>
      <span class="kd">var</span> <span class="nx">Tdie</span> <span class="o">=</span> <span class="nx">ac</span> <span class="o">+</span> <span class="mf">273.15</span>
      <span class="kd">var</span> <span class="nx">S0</span> <span class="o">=</span>  <span class="mf">6.4</span><span class="nx">E</span><span class="o">-</span><span class="mi">14</span> <span class="c1">// calibration factor</span>
      <span class="kd">var</span> <span class="nx">a1</span> <span class="o">=</span>  <span class="mf">1.750</span><span class="nx">E</span><span class="o">-</span><span class="mi">3</span>
      <span class="kd">var</span> <span class="nx">a2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.678</span><span class="nx">E</span><span class="o">-</span><span class="mi">5</span>
      <span class="kd">var</span> <span class="nx">b0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.940</span><span class="nx">E</span><span class="o">-</span><span class="mi">5</span>
      <span class="kd">var</span> <span class="nx">b1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.700</span><span class="nx">E</span><span class="o">-</span><span class="mi">7</span>
      <span class="kd">var</span> <span class="nx">b2</span> <span class="o">=</span>  <span class="mf">4.630</span><span class="nx">E</span><span class="o">-</span><span class="mi">9</span>
      <span class="kd">var</span> <span class="nx">c2</span> <span class="o">=</span> <span class="mf">13.4</span>
      <span class="kd">var</span> <span class="nx">Tref</span> <span class="o">=</span> <span class="mf">298.15</span>
      <span class="kd">var</span> <span class="nx">S</span> <span class="o">=</span> <span class="nx">S0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nx">a1</span> <span class="o">*</span> <span class="p">(</span><span class="nx">Tdie</span> <span class="o">-</span> <span class="nx">Tref</span><span class="p">)</span> <span class="o">+</span> <span class="nx">a2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">((</span><span class="nx">Tdie</span> <span class="o">-</span> <span class="nx">Tref</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
      <span class="kd">var</span> <span class="nx">Vos</span> <span class="o">=</span> <span class="nx">b0</span> <span class="o">+</span> <span class="nx">b1</span> <span class="o">*</span> <span class="p">(</span><span class="nx">Tdie</span> <span class="o">-</span> <span class="nx">Tref</span><span class="p">)</span> <span class="o">+</span> <span class="nx">b2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">((</span><span class="nx">Tdie</span> <span class="o">-</span> <span class="nx">Tref</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
      <span class="kd">var</span> <span class="nx">fObj</span> <span class="o">=</span> <span class="p">(</span><span class="nx">Vobj2</span> <span class="o">-</span> <span class="nx">Vos</span><span class="p">)</span> <span class="o">+</span> <span class="nx">c2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">((</span><span class="nx">Vobj2</span> <span class="o">-</span> <span class="nx">Vos</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
      <span class="kd">var</span> <span class="nx">tObj</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">Tdie</span><span class="p">,</span> <span class="mi">4</span> <span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">fObj</span> <span class="o">/</span> <span class="nx">S</span><span class="p">),</span> <span class="mf">0.25</span><span class="p">)</span>
      <span class="kd">var</span> <span class="nx">tc</span> <span class="o">=</span> <span class="nx">tObj</span> <span class="o">-</span> <span class="mf">273.15</span></pre></div></td></tr><tr id="section-59"><td class="docs"><div class="pilwrap"><a href="#section-59" class="pilcrow">&#182;</a></div><p>Return result.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">return</span> <span class="p">{</span> <span class="nx">ambientTemperature</span><span class="o">:</span> <span class="nx">ac</span><span class="p">,</span> <span class="nx">targetTemperature</span><span class="o">:</span> <span class="nx">tc</span> <span class="p">}</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-60"><td class="docs"><div class="pilwrap"><a href="#section-60" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Calculate accelerometer values from raw data.
     * @param data - an Uint8Array.
     * @return Object with fields: x, y, z.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">getAccelerometerValues</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">{</span></pre></div></td></tr><tr id="section-61"><td class="docs"><div class="pilwrap"><a href="#section-61" class="pilcrow">&#182;</a></div><p>Calculate accelerometer values.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">ax</span> <span class="o">=</span> <span class="nx">evothings</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">littleEndianToInt8</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">16.0</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">ay</span> <span class="o">=</span> <span class="nx">evothings</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">littleEndianToInt8</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">16.0</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">az</span> <span class="o">=</span> <span class="nx">evothings</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">littleEndianToInt8</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">16.0</span><span class="p">;</span></pre></div></td></tr><tr id="section-62"><td class="docs"><div class="pilwrap"><a href="#section-62" class="pilcrow">&#182;</a></div><p>Return result.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">return</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="nx">ax</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">ay</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="nx">az</span> <span class="p">}</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-63"><td class="docs"><div class="pilwrap"><a href="#section-63" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Calculate humidity values from raw data.
     * @param data - an Uint8Array.
     * @return Object with fields: humidityTemperature, relativeHumidity.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">getHumidityValues</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">{</span></pre></div></td></tr><tr id="section-64"><td class="docs"><div class="pilwrap"><a href="#section-64" class="pilcrow">&#182;</a></div><p>Calculate the humidity temperature (Celsius).</p>
</td><td class="code"><div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">tc</span> <span class="o">=</span> <span class="o">-</span><span class="mf">46.85</span> <span class="o">+</span> <span class="mf">175.72</span> <span class="o">/</span> <span class="mf">65536.0</span> <span class="o">*</span> <span class="nx">evothings</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">littleEndianToInt16</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></pre></div></td></tr><tr id="section-65"><td class="docs"><div class="pilwrap"><a href="#section-65" class="pilcrow">&#182;</a></div><p>Calculate the relative humidity.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.0</span> <span class="o">+</span> <span class="mf">125.00</span> <span class="o">/</span> <span class="mf">65536.0</span> <span class="o">*</span> <span class="p">(</span><span class="nx">evothings</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">littleEndianToInt16</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mh">0x03</span><span class="p">)</span></pre></div></td></tr><tr id="section-66"><td class="docs"><div class="pilwrap"><a href="#section-66" class="pilcrow">&#182;</a></div><p>Return result.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">return</span> <span class="p">{</span> <span class="nx">humidityTemperature</span><span class="o">:</span> <span class="nx">tc</span><span class="p">,</span> <span class="nx">relativeHumidity</span><span class="o">:</span> <span class="nx">h</span> <span class="p">}</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-67"><td class="docs"><div class="pilwrap"><a href="#section-67" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Calculate magnetometer values from raw data.
     * @param data - an Uint8Array.
     * @return Object with fields: x, y, z.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">getMagnetometerValues</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">{</span></pre></div></td></tr><tr id="section-68"><td class="docs"><div class="pilwrap"><a href="#section-68" class="pilcrow">&#182;</a></div><p>Magnetometer values (Micro Tesla).</p>
</td><td class="code"><div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">mx</span> <span class="o">=</span> <span class="nx">evothings</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">littleEndianToInt16</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2000.0</span> <span class="o">/</span> <span class="mf">65536.0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
      <span class="kd">var</span> <span class="nx">my</span> <span class="o">=</span> <span class="nx">evothings</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">littleEndianToInt16</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2000.0</span> <span class="o">/</span> <span class="mf">65536.0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
      <span class="kd">var</span> <span class="nx">mz</span> <span class="o">=</span> <span class="nx">evothings</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">littleEndianToInt16</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2000.0</span> <span class="o">/</span> <span class="mf">65536.0</span><span class="p">)</span></pre></div></td></tr><tr id="section-69"><td class="docs"><div class="pilwrap"><a href="#section-69" class="pilcrow">&#182;</a></div><p>Return result.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">return</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="nx">mx</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">my</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="nx">mz</span> <span class="p">}</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-70"><td class="docs"><div class="pilwrap"><a href="#section-70" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Calculate barometer values from raw data.
     * TODO: Implement (not implemented).</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">getBarometerValues</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">{</span></pre></div></td></tr><tr id="section-71"><td class="docs"><div class="pilwrap"><a href="#section-71" class="pilcrow">&#182;</a></div><p>Not implemented.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">return</span> <span class="p">{}</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-72"><td class="docs"><div class="pilwrap"><a href="#section-72" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Calculate gyroscope values from raw data.
     * @param data - an Uint8Array.
     * @return Object with fields: x, y, z.</li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">instance</span><span class="p">.</span><span class="nx">getGyroscopeValues</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">{</span></pre></div></td></tr><tr id="section-73"><td class="docs"><div class="pilwrap"><a href="#section-73" class="pilcrow">&#182;</a></div><p>Calculate gyroscope values. NB: x,y,z has a weird order.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">gy</span> <span class="o">=</span> <span class="o">-</span><span class="nx">evothings</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">littleEndianToInt16</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">500.0</span> <span class="o">/</span> <span class="mf">65536.0</span>
      <span class="kd">var</span> <span class="nx">gx</span> <span class="o">=</span>  <span class="nx">evothings</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">littleEndianToInt16</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">500.0</span> <span class="o">/</span> <span class="mf">65536.0</span>
      <span class="kd">var</span> <span class="nx">gz</span> <span class="o">=</span>  <span class="nx">evothings</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">littleEndianToInt16</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="mf">500.0</span> <span class="o">/</span> <span class="mf">65536.0</span></pre></div></td></tr><tr id="section-74"><td class="docs"><div class="pilwrap"><a href="#section-74" class="pilcrow">&#182;</a></div><p>Return result.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="k">return</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="nx">gx</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">gy</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="nx">gz</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">instance</span><span class="p">.</span><span class="nx">celsiusToFahrenheit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">celsius</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="p">(</span><span class="nx">celsius</span> <span class="o">*</span> <span class="mi">9</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">32</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-75"><td class="docs"><div class="pilwrap"><a href="#section-75" class="pilcrow">&#182;</a></div><p>Finally, return the SensorTag instance object.</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">return</span> <span class="nx">instance</span>
  <span class="p">}</span></pre></div></td></tr><tr id="section-76"><td class="docs"><div class="pilwrap"><a href="#section-76" class="pilcrow">&#182;</a></div><p>Return the SensorTag 'class' object.</p>
</td><td class="code"><div class="highlight"><pre>  <span class="k">return</span> <span class="nx">sensortag</span>
<span class="p">})()</span>

</pre></div></td></tr></tbody></table><div id="generated">generated Sun Apr 26 2015 14:18:06 GMT+1000 (ChST)  </div><div id="projectname"><a href="../../../index.html">Stag App</a></div></div></body></html>