<!DOCTYPE html><html><head><title>pages.coffee</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="./docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="./index.html" class="source"><span class="file_name">README</span></a><a href="./app.coffee.html" class="source "><span class="base_path">. / </span><span class="file_name">app.coffee</span></a><a href="./libs/evothings/easyble/easyble.js.html" class="source "><span class="base_path">libs / evothings / easyble / </span><span class="file_name">easyble.js</span></a><a href="./libs/evothings/tisensortag/tisensortag.js.html" class="source "><span class="base_path">libs / evothings / tisensortag / </span><span class="file_name">tisensortag.js</span></a><a href="./libs/evothings/util/util.js.html" class="source "><span class="base_path">libs / evothings / util / </span><span class="file_name">util.js</span></a><a href="./pages.coffee.html" class="source selected"><span class="base_path">. / </span><span class="file_name">pages.coffee</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>pages.coffee</h1><div class="filepath">./</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div><p>vim: et:ts=2:sw=2:sts=2:nowrap</p>
</td><td class="code"><div class="highlight"><pre><span class="nv">implementing = </span><span class="nf">(mixins..., classReference) -&gt;</span>
  <span class="k">for</span> <span class="nx">mixin</span> <span class="k">in</span> <span class="nx">mixins</span>
    <span class="k">for</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span> <span class="k">of</span> <span class="nv">mixin::</span>
      <span class="nx">classReference</span><span class="o">::</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span>
  <span class="nx">classReference</span>

<span class="k">class</span> <span class="nx">Pages</span>
  <span class="nv">Teacup = </span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;teacup&#39;</span><span class="p">)</span>
  <span class="nx">$</span><span class="o">=</span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;jquery&#39;</span><span class="p">)</span>
  <span class="nv">tea = </span><span class="k">new</span> <span class="nx">Teacup</span><span class="p">.</span><span class="nx">Teacup</span>
  <span class="p">{</span><span class="nx">a</span><span class="p">,</span><span class="nx">render</span><span class="p">,</span><span class="nx">input</span><span class="p">,</span><span class="nx">renderable</span><span class="p">,</span><span class="nx">raw</span><span class="p">,</span><span class="nx">div</span><span class="p">,</span><span class="nx">img</span><span class="p">,</span><span class="nx">h2</span><span class="p">,</span><span class="nx">h3</span><span class="p">,</span><span class="nx">h4</span><span class="p">,</span><span class="nx">h5</span><span class="p">,</span><span class="nx">label</span><span class="p">,</span><span class="nx">button</span><span class="p">,</span><span class="nx">p</span><span class="p">,</span><span class="nx">text</span><span class="p">,</span><span class="nx">span</span><span class="p">,</span><span class="nx">canvas</span><span class="p">,</span><span class="nx">option</span><span class="p">,</span><span class="nx">select</span><span class="p">,</span><span class="nx">form</span><span class="p">,</span><span class="nx">body</span><span class="p">,</span><span class="nx">head</span><span class="p">,</span><span class="nx">doctype</span><span class="p">,</span><span class="nx">hr</span><span class="p">,</span><span class="nx">br</span><span class="p">,</span><span class="nx">password</span><span class="p">}</span> <span class="o">=</span> <span class="nx">tea</span><span class="p">.</span><span class="nx">tags</span><span class="p">()</span>

  <span class="nv">sessionInfo: </span><span class="p">{}</span>

  <span class="nv">admin: </span><span class="p">{}</span>

  <span class="nv">getAdmin: </span><span class="nf">(kind) =&gt;</span>
    <span class="k">return</span> <span class="nx">@admin</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">kind</span><span class="p">).</span><span class="nx">toArray</span><span class="p">()</span>

  <span class="nv">constructor: </span><span class="nf">(@admin,@sessionInfo) -&gt;</span>
      <span class="nv">tea.getAdmin = </span> <span class="nx">@getAdmin</span></pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><p>Teacup.Teacup.prototype.admin = @admin
Teacup.Teacup.prototype.Page = @</p>
</td><td class="code"><div class="highlight"><pre>  <span class="nv">theBody: </span><span class="nx">renderable</span> <span class="nf">(buttons,contents1,contents2)=&gt;</span>
    <span class="nx">div</span> <span class="s">&#39;#capture-display.container&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
      <span class="nx">div</span> <span class="s">&#39;.row&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
        <span class="nx">a</span> <span class="nv">href: </span><span class="s">&#39;/index.html&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
          <span class="nx">img</span> <span class="s">&quot;#logo.five.columns&quot;</span><span class="p">,</span> <span class="nv">src: </span><span class="s">&#39;./ui/images/logo-final.png&#39;</span><span class="p">,</span> <span class="nv">width: </span><span class="s">&#39;100%&#39;</span>
        <span class="nx">div</span> <span class="s">&#39;#dud.one.columns&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
          <span class="nx">raw</span> <span class="s">&#39;&amp;nbsp;&#39;</span>
        <span class="nx">h5</span> <span class="s">&#39;.five.columns&#39;</span><span class="p">,</span> <span class="s">&#39;Movement data capture&#39;</span>
      <span class="nx">buttons</span><span class="p">()</span>
      <span class="nx">div</span> <span class="s">&#39;.row&#39;</span><span class="p">,</span><span class="nf">-&gt;</span>
        <span class="nx">div</span> <span class="s">&#39;.two.columns&#39;</span><span class="p">,</span><span class="s">&quot;Sensor --&quot;</span>
        <span class="nx">div</span> <span class="s">&#39;.two.columns&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
          <span class="nx">text</span> <span class="s">&#39;Version:&#39;</span>
          <span class="nx">span</span> <span class="s">&#39;#FirmwareData&#39;</span><span class="p">,</span> <span class="s">&#39;?&#39;</span>
        <span class="nx">div</span> <span class="s">&#39;#uuid.five.columns&#39;</span> <span class="p">,</span> <span class="s">&#39; &#39;</span>
      <span class="nx">div</span> <span class="s">&#39;.row&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
        <span class="nx">div</span> <span class="s">&#39;.four.columns&#39;</span><span class="p">,</span><span class="s">&quot;Platform uuid&quot;</span>
        <span class="nx">div</span> <span class="s">&#39;#platformUUID.five.columns&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
          <span class="nx">raw</span> <span class="s">&#39;&amp;nbsp;&#39;</span>
        
      <span class="nx">contents1</span><span class="p">()</span>
      <span class="nx">contents2</span><span class="p">()</span>
      <span class="nx">div</span> <span class="s">&#39;#footer&#39;</span><span class="p">,</span><span class="s">&#39;style=&quot;display:none;&quot;&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
        <span class="nx">hr</span><span class="p">()</span>
        <span class="nx">div</span> <span class="s">&#39;#console-log.container&#39;</span>

  <span class="nv">adminContents: </span><span class="nx">renderable</span> <span class="nf">()-&gt;</span>
     <span class="nx">div</span> <span class="s">&#39;#adminForm&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
      <span class="nx">hr</span><span class="p">()</span> 
      <span class="nx">form</span> <span class="nf">-&gt;</span>
        <span class="nx">div</span> <span class="s">&#39;.row&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
          <span class="nx">div</span> <span class="s">&#39;.five.columns&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
            <span class="nx">label</span> <span class="s">&#39;Remote Host&#39;</span>
            <span class="nx">select</span> <span class="s">&#39;#desiredHost.u-full-width&#39;</span><span class="p">,</span> <span class="nv">onchange: </span><span class="s">&quot;&quot;</span> <span class="p">,</span> <span class="s">&#39;Host&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
              <span class="nx">option</span> <span class="s">&quot;Select ---&quot;</span>
              <span class="k">for</span> <span class="nx">host</span> <span class="k">in</span> <span class="nx">@getAdmin</span><span class="p">(</span><span class="s">&#39;host&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nx">host</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;force&#39;</span><span class="p">)</span>
                  <span class="nx">option</span> <span class="s">&#39;.forceSelect.selected&#39;</span><span class="p">,</span> <span class="nv">selected: </span><span class="s">&#39;selected&#39;</span><span class="p">,</span> <span class="nv">value: </span><span class="nx">host</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;url&#39;</span><span class="p">),</span> <span class="nx">host</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span>
                <span class="k">else</span>
                  <span class="nx">option</span> <span class="nv">value: </span><span class="nx">host</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;url&#39;</span><span class="p">),</span> <span class="nx">host</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span>
        <span class="nx">div</span> <span class="s">&#39;.row&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
          <span class="nx">div</span> <span class="s">&#39;.four.columns&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
            <span class="nx">label</span> <span class="k">for</span><span class="o">:</span> <span class="s">&#39;clinician&#39;</span><span class="p">,</span><span class="s">&#39;Clinician&#39;</span>
            <span class="nx">select</span> <span class="s">&#39;#clinician.u-full-width&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
              <span class="nx">option</span> <span class="s">&quot;Select ---&quot;</span>
              <span class="k">for</span> <span class="nx">user</span> <span class="k">in</span> <span class="nx">@getAdmin</span><span class="p">(</span><span class="s">&#39;user&#39;</span><span class="p">)</span> <span class="k">when</span> <span class="o">!</span><span class="nx">user</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;patientOnly&#39;</span><span class="p">)</span>
                <span class="nx">option</span> <span class="nv">value: </span><span class="nx">user</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">),</span> <span class="nx">user</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span>
            <span class="nx">br</span><span class="p">()</span>
            <span class="nx">label</span> <span class="k">for</span><span class="o">:</span> <span class="s">&quot;password&quot;</span><span class="p">,</span> <span class="s">&quot;Enter Password&quot;</span>
            <span class="nx">input</span> <span class="s">&quot;#password&quot;</span><span class="p">,</span> <span class="nv">type: </span><span class="s">&#39;password&#39;</span>
          <span class="nx">div</span> <span class="s">&#39;.four.columns&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
            <span class="nx">label</span> <span class="k">for</span><span class="o">:</span> <span class="s">&#39;patient&#39;</span><span class="p">,</span> <span class="s">&#39;Client&#39;</span>
            <span class="nx">select</span> <span class="s">&#39;#patient.u-full-width&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
              <span class="nx">option</span> <span class="s">&quot;Select ---&quot;</span>
              <span class="k">for</span> <span class="nx">p</span> <span class="k">in</span> <span class="nx">@getAdmin</span><span class="p">(</span><span class="s">&#39;user&#39;</span><span class="p">)</span> <span class="k">when</span> <span class="nx">p</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;patientOnly&#39;</span><span class="p">)</span>
                <span class="nx">option</span> <span class="nv">value: </span><span class="nx">p</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">),</span> <span class="nx">p</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span>
        <span class="nx">div</span> <span class="s">&#39;.row&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
          <span class="nx">div</span> <span class="s">&#39;.nine.columns&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
            <span class="nx">raw</span> <span class="s">&quot;&amp;nbsp;&quot;</span>
          <span class="nx">button</span> <span class="s">&#39;#done.three.columns&#39;</span><span class="p">,</span> <span class="nv">disabled: </span><span class="kc">true</span><span class="p">,</span> <span class="s">&quot;Done&quot;</span>

  <span class="nv">modelCheck: </span><span class="nf">()=&gt;</span>
    <span class="nv">model = </span><span class="nx">@sessionInfo</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span> <span class="s">&#39;hostUrl&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span> <span class="s">&#39;clinician&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> 
      <span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span> <span class="s">&#39;patient&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="s">&#39;retro2015&#39;</span> <span class="o">==</span> <span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span> <span class="s">&#39;password&#39;</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s">&#39;activating&#39;</span><span class="p">)</span>
        <span class="nx">b</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#done&#39;</span><span class="p">)</span>
        <span class="nx">b</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s">&#39;button-primary&#39;</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s">&#39;disabled&#39;</span><span class="p">).</span><span class="nx">removeAttr</span><span class="p">(</span><span class="s">&#39;disabled&#39;</span><span class="p">)</span>
        <span class="nx">b</span><span class="p">.</span><span class="nx">on</span> <span class="s">&#39;click&#39;</span><span class="p">,</span> <span class="nx">@done</span>
        <span class="nx">b</span><span class="p">.</span><span class="nx">text</span> <span class="s">&quot;Done&quot;</span>
        <span class="nx">b</span><span class="p">.</span><span class="nx">show</span><span class="p">().</span><span class="nx">fadeTo</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">true</span>
    <span class="k">return</span> <span class="kc">false</span>
  
  <span class="nv">wireButtons: </span><span class="nf">=&gt;</span>
    <span class="nv">model = </span><span class="nx">@sessionInfo</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#TestID&#39;</span><span class="p">).</span><span class="nx">change</span> <span class="nf">(node)=&gt;</span>
      <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#TestSelect&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s">&#39;Which Test?&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s">&#39;color&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span>
      <span class="nx">model</span><span class="p">.</span><span class="nx">set</span> <span class="s">&#39;testID&#39;</span><span class="p">,</span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#TestID option:selected&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
      <span class="k">return</span> <span class="kc">false</span>

  <span class="nv">resetAdmin: </span><span class="nf">=&gt;</span>
    <span class="nx">@sessionInfo</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s">&#39;clinician&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="nx">@sessionInfo</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s">&#39;password&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="nx">@sessionInfo</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s">&#39;patient&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="nx">@sessionInfo</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s">&#39;testID&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span>

    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#password&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;option:selected&#39;</span><span class="p">).</span><span class="nx">prop</span><span class="p">(</span><span class="s">&#39;selected&#39;</span><span class="p">,</span><span class="kc">false</span><span class="p">)</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;option.forceSelect&#39;</span><span class="p">).</span><span class="nx">prop</span><span class="p">(</span><span class="s">&#39;selected&#39;</span><span class="p">,</span><span class="kc">true</span><span class="p">)</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#done&#39;</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s">&#39;button-primary&#39;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s">&#39;disabled&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&#39;disabled&#39;</span><span class="p">,</span><span class="s">&#39;disabled&#39;</span><span class="p">).</span><span class="nx">off</span><span class="p">(</span><span class="s">&#39;click&#39;</span><span class="p">)</span>
    <span class="nx">@sessionInfo</span><span class="p">.</span><span class="nx">set</span> <span class="s">&#39;hostUrl&#39;</span><span class="p">,</span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#desiredHost option:selected&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>

  <span class="nv">wireAdmin: </span><span class="nf">=&gt;</span>
    <span class="nv">model = </span><span class="nx">@sessionInfo</span>
    <span class="nx">model</span><span class="p">.</span><span class="nx">set</span> <span class="s">&#39;hostUrl&#39;</span><span class="p">,</span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#desiredHost option:selected&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#desiredHost&#39;</span><span class="p">).</span><span class="nx">change</span> <span class="nf">(node) =&gt;</span>
      <span class="nx">model</span><span class="p">.</span><span class="nx">set</span> <span class="s">&#39;hostUrl&#39;</span><span class="p">,</span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#desiredHost option:selected&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
      <span class="nx">@modelCheck</span><span class="p">()</span>
      <span class="k">return</span> <span class="kc">false</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#clinician&#39;</span><span class="p">).</span><span class="nx">change</span> <span class="nf">(node) =&gt;</span>
      <span class="nx">model</span><span class="p">.</span><span class="nx">set</span> <span class="s">&#39;clinician&#39;</span><span class="p">,</span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#clinician option:selected&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
      <span class="nx">@modelCheck</span><span class="p">()</span>
      <span class="k">return</span> <span class="kc">false</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#patient&#39;</span><span class="p">).</span><span class="nx">change</span> <span class="nf">(node) =&gt;</span>
      <span class="nx">model</span><span class="p">.</span><span class="nx">set</span> <span class="s">&#39;patient&#39;</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#patient option:selected&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
      <span class="nx">@modelCheck</span><span class="p">()</span>
      <span class="k">return</span> <span class="kc">false</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#password&#39;</span><span class="p">).</span><span class="nx">keypress</span><span class="p">(</span> <span class="nf">(node)=&gt;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">keyCode</span> <span class="o">==</span> <span class="mi">13</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">node</span><span class="p">.</span><span class="nx">shiftKey</span><span class="p">)</span>
          <span class="nx">node</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span> <span class="c1">#disallow page reload default</span>

          <span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#password&#39;</span><span class="p">)</span><span class="o">?</span><span class="p">.</span><span class="nx">val</span>
            <span class="nx">model</span><span class="p">.</span><span class="nx">set</span> <span class="s">&#39;password&#39;</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#password&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
            <span class="nx">@modelCheck</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">false</span> <span class="c1">#stop bubble up</span>
        <span class="k">return</span>
       <span class="p">).</span><span class="nx">on</span> <span class="s">&#39;blur&#39;</span><span class="p">,</span> <span class="nf">(node) =&gt;</span>
          <span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#password&#39;</span><span class="p">)</span><span class="o">?</span><span class="p">.</span><span class="nx">val</span>
            <span class="nx">model</span><span class="p">.</span><span class="nx">set</span> <span class="s">&#39;password&#39;</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#password&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
            <span class="nx">@modelCheck</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">false</span> <span class="c1">#stop bubble up</span>
    <span class="k">return</span>   <span class="c1">#otherwise allow bubble-up and default action</span>

  <span class="nv">topButtons: </span><span class="nx">renderable</span> <span class="nf">()-&gt;</span>
      <span class="nx">div</span> <span class="s">&#39;.row&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
        <span class="nx">button</span> <span class="s">&#39;#admin.three.columns button-primary&#39;</span><span class="p">,</span> <span class="s">&#39;Admin&#39;</span>
        <span class="nx">button</span> <span class="s">&#39;#calibrate.three.columns.disabled.grayonly&#39;</span><span class="p">,</span> <span class="s">&#39;Calibrate&#39;</span>
        <span class="nx">button</span> <span class="s">&#39;.three.columns.disabled&#39;</span><span class="p">,</span> <span class="nv">style: </span><span class="s">&quot;opacity:0.25;&quot;</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
        <span class="nx">button</span> <span class="s">&#39;#debug.three.columns.disabled&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
      <span class="nx">div</span> <span class="s">&#39;.row&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
        <span class="nx">div</span> <span class="s">&#39;.three.columns&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
          <span class="nx">label</span> <span class="s">&#39;#TestSelect&#39;</span><span class="p">,</span> <span class="k">for</span><span class="o">:</span> <span class="s">&quot;TestID&quot;</span><span class="p">,</span> <span class="s">&#39;Which Test?&#39;</span>
          <span class="nx">select</span> <span class="s">&quot;#TestID.u-full-width&quot;</span><span class="p">,</span>  <span class="nf">-&gt;</span>
            <span class="nx">option</span> <span class="s">&quot;Select --&quot;</span>
            <span class="k">for</span> <span class="nx">test</span> <span class="k">in</span> <span class="nx">@getAdmin</span><span class="p">(</span><span class="s">&#39;testIDs&#39;</span><span class="p">)</span>
              <span class="nx">option</span> <span class="nv">value: </span><span class="nx">test</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span> <span class="p">,</span> <span class="nx">test</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;Description&#39;</span><span class="p">)</span>
        <span class="nx">div</span> <span class="s">&#39;.three.columns&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
          <span class="nx">button</span> <span class="s">&#39;#action.disabled.u-full-width&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
          <span class="nx">label</span> <span class="s">&#39;#TotalReadings&#39;</span><span class="p">,</span> <span class="k">for</span><span class="o">:</span> <span class="s">&quot;action&quot;</span><span class="p">,</span> <span class="s">&#39; 0&#39;</span>
        <span class="nx">div</span> <span class="s">&#39;.three.columns&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
          <span class="nx">button</span> <span class="s">&#39;#upload.disabled.u-full-width&#39;</span><span class="p">,</span> <span class="s">&#39;Upload&#39;</span>
          <span class="nx">label</span> <span class="s">&#39;#StatusData&#39;</span><span class="p">,</span><span class="k">for</span><span class="o">:</span> <span class="s">&quot;upload&quot;</span><span class="p">,</span> <span class="s">&#39;No connection&#39;</span>
        <span class="nx">button</span> <span class="s">&#39;#clear.three.columns.disabled&#39;</span><span class="p">,</span> <span class="s">&#39;Reset&#39;</span>

  <span class="nv">forceTest: </span><span class="nf">(color = &#39;violet&#39;) =&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#TestSelect&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s">&#39;Must Select Test&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s">&#39;color&#39;</span><span class="p">,</span><span class="nx">color</span><span class="p">)</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#TestID&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="s">&#39;Select --&#39;</span><span class="p">)</span>
    <span class="nx">@sessionInfo</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s">&#39;testID&#39;</span><span class="p">,</span><span class="kc">null</span><span class="p">)</span>

  <span class="nv">sensorContents: </span><span class="nx">renderable</span> <span class="nf">-&gt;</span>
    <span class="nx">div</span> <span class="s">&#39;#sensorPage.container&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
      <span class="nx">hr</span><span class="p">()</span>
      <span class="nx">div</span> <span class="s">&#39;.row.readings&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
        <span class="nx">div</span> <span class="s">&#39;#gyroscope.four.columns&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
          <span class="nx">h5</span> <span class="s">&#39;Gyroscope&#39;</span>
          <span class="nx">canvas</span> <span class="s">&#39;#gyro-view&#39;</span><span class="p">,</span> <span class="nv">width: </span><span class="s">&#39;200&#39;</span><span class="p">,</span> <span class="nv">height: </span><span class="s">&#39;200&#39;</span><span class="p">,</span> <span class="nv">style: </span><span class="s">&#39;width=100%&#39;</span>
          <span class="nx">div</span> <span class="s">&#39;#GyroscopeData.u-full-width.dump&#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span></pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><p>button '#calibrateGyro.suppress.three columns', 'Debias'</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">div</span> <span class="s">&#39;#acelleration.four.columns&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
          <span class="nx">h5</span> <span class="s">&#39;Accelerometer&#39;</span>
          <span class="nx">canvas</span> <span class="s">&#39;#accel-view&#39;</span><span class="p">,</span> <span class="nv">width: </span><span class="s">&#39;200&#39;</span><span class="p">,</span> <span class="nv">height: </span><span class="s">&#39;200&#39;</span><span class="p">,</span> <span class="nv">style: </span><span class="s">&#39;width=100%&#39;</span>
          <span class="nx">div</span> <span class="s">&#39;#AccelerometerData.u-full-width.dump&#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span></pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><p>button '#calibrateAccel.suppress.three columns', 'Debias'</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">div</span> <span class="s">&#39;#magnetometer.four.columns&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
          <span class="nx">h5</span> <span class="s">&#39;Magnetometer&#39;</span>
          <span class="nx">canvas</span> <span class="s">&#39;#magnet-view&#39;</span><span class="p">,</span> <span class="nv">width: </span><span class="s">&#39;200&#39;</span><span class="p">,</span> <span class="nv">height: </span><span class="s">&#39;200&#39;</span><span class="p">,</span> <span class="nv">style: </span><span class="s">&#39;width=100%&#39;</span>
          <span class="nx">div</span> <span class="s">&#39;#MagnetometerData.u-full-width.dump&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span></pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><p>button '#calibrateMag.suppress.three columns', 'Debias'</p>
</td><td class="code"><div class="highlight"><pre>  <span class="nv">activateButtons: </span><span class="nf">(buttonStruct) -&gt;</span>
    <span class="k">for</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">btn</span> <span class="k">of</span> <span class="nx">buttonStruct</span>
      <span class="nx">btn</span><span class="o">=</span><span class="nx">btn</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">()</span>
      <span class="nv">selector = </span><span class="s">&#39;#&#39;</span> <span class="o">+</span> <span class="nx">btn</span><span class="p">.</span><span class="nx">selector</span>
      <span class="k">if</span> <span class="nx">btn</span><span class="p">.</span><span class="nx">active</span>
        <span class="nx">b</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s">&#39;button-primary&#39;</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s">&#39;disabled&#39;</span><span class="p">).</span><span class="nx">removeAttr</span><span class="p">(</span><span class="s">&#39;disabled&#39;</span><span class="p">).</span><span class="nx">off</span><span class="p">(</span><span class="s">&#39;click&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">btn</span><span class="p">.</span><span class="nx">funct</span><span class="o">?</span> <span class="k">then</span> <span class="nx">b</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s">&#39;click&#39;</span><span class="p">,</span><span class="nx">btn</span><span class="p">.</span><span class="nx">funct</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">btn</span><span class="p">.</span><span class="nx">text</span><span class="o">?</span> <span class="k">then</span> <span class="nx">b</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">btn</span><span class="p">.</span><span class="nx">text</span><span class="p">)</span>
        <span class="nx">b</span><span class="p">.</span><span class="nx">show</span><span class="p">().</span><span class="nx">fadeTo</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">else</span>
        <span class="nx">b</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s">&#39;button-primary&#39;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s">&#39;disabled&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&#39;disabled&#39;</span><span class="p">,</span><span class="s">&#39;disabled&#39;</span><span class="p">).</span><span class="nx">off</span><span class="p">(</span><span class="s">&#39;click&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">btn</span><span class="p">.</span><span class="nx">text</span><span class="o">?</span> <span class="k">then</span> <span class="nx">b</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">btn</span><span class="p">.</span><span class="nx">text</span><span class="p">)</span>
        <span class="nx">b</span><span class="p">.</span><span class="nx">fadeTo</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mf">0.25</span><span class="p">)</span>

  <span class="nv">renderPage: </span><span class="nf">(@done) =&gt;</span>
    <span class="nv">bodyHtml = </span><span class="nx">@theBody</span> <span class="nx">@topButtons</span> <span class="p">,</span> <span class="nx">@adminContents</span><span class="p">,</span> <span class="nx">@sensorContents</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;body&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="nx">bodyHtml</span>
    <span class="nx">@wireButtons</span><span class="p">()</span>
    <span class="nx">@wireAdmin</span><span class="p">()</span>
    <span class="k">return</span>

  <span class="nv">activateAdminPage: </span><span class="nf">(buttonSpec)-&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#sensorPage&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#adminForm&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">()</span>
    <span class="nx">@activateButtons</span> <span class="nx">buttonSpec</span> <span class="k">if</span> <span class="nx">buttonSpec</span><span class="o">?</span>

  <span class="nv">activateSensorPage: </span><span class="nf">(buttonSpec)-&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#adminForm&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#sensorPage&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">()</span>
    <span class="nx">@activateButtons</span> <span class="nx">buttonSpec</span> <span class="k">if</span> <span class="nx">buttonSpec</span><span class="o">?</span>

<span class="nv">exports.Pages = </span><span class="nx">Pages</span>

</pre></div></td></tr></tbody></table><div id="generated">generated Sun Apr 26 2015 14:18:06 GMT+1000 (ChST)  </div><div id="projectname"><a href="./index.html">Stag App</a></div></div></body></html>